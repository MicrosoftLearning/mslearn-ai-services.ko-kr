---
lab:
  title: Azure AI 콘텐츠 보안 구현
---

# Azure AI 콘텐츠 보안 구현

이 연습에서는 콘텐츠 보안 리소스를 프로비전하고, Azure AI 스튜디오에서 리소스를 테스트하고, 코드에서 리소스를 테스트합니다.

## *콘텐츠 보안* 리소스 프로비전

아직 없는 경우 Azure 구독에서 **콘텐츠 보안** 리소스를 프로비전해야 합니다.

1. `https://portal.azure.com`의 Azure Portal을 열고 Azure 구독과 연관된 Microsoft 계정을 사용하여 로그인합니다.
1. **리소스 만들기**를 선택합니다.
1. 검색 필드에서 **콘텐츠 보안**을 검색합니다. 그런 다음 결과에서 **Azure AI 콘텐츠 보안**에서 **만들기**를 선택합니다.
1. 다음 설정을 사용하여 리소스를 프로비전합니다.
    - **구독**: *자신의 Azure 구독*.
    - **리소스 그룹**: *리소스 그룹을 선택하거나 만듭니다*.
    - **지역**: **미국 동부**를 선택합니다.
    - **이름**: 고유한 이름을 입력합니다.
    - **가격 책정 계층**: **F0**(*무료*), F0을 사용할 수 없는 경우 **S**(*표준*)를 선택합니다.
1. **검토 + 만들기를** 선택한 다음, **만들기**를 선택하여 리소스를 프로비전합니다.
1. 배포가 완료될 때까지 기다린 다음, 리소스로 이동합니다.
1. 왼쪽 탐색 모음에서 **액세스 제어**를 선택한 다음 **+ 추가** 및 **역할 할당 추가**를 선택합니다.
1. 아래로 스크롤하여 **Cognitive Services 사용자** 역할을 선택한 후 **다음**을 선택합니다.
1. 이 역할에 계정을 추가한 다음 **검토 + 할당**을 선택합니다.
1. 왼쪽 탐색 모음에서 **리소스 관리**를 선택하고 **키 및 엔드포인트**를 선택합니다. 나중에 키를 복사할 수 있도록 이 페이지를 열어 두세요.

## Azure AI 콘텐츠 보안 프롬프트 쉴드 사용

이 연습에서는 Azure AI 스튜디오를 사용하여 두 개의 샘플 입력으로 콘텐츠 보안 프롬프트 쉴드를 테스트합니다. 하나는 사용자 프롬프트를 시뮬레이션하고 다른 하나는 잠재적으로 안전하지 않은 텍스트가 임베딩된 문서를 시뮬레이션합니다.

1. 다른 브라우저 탭에서 [Azure AI 스튜디오](https://ai.azure.com/explore/contentsafety)의 콘텐츠 보안 페이지를 열고 로그인합니다.
1. **텍스트 콘텐츠 수정**에서 **사용해 보기**를 선택합니다.
1. **텍스트 콘텐츠 수정** 페이지의 **Azure AI 서비스**에서 이전에 만든 콘텐츠 보안 리소스를 선택합니다.
1. **한 문장의 여러 위험 범주**를 선택합니다. 문서 텍스트에서 잠재적인 문제가 있는지 검토합니다.
1. **테스트 실행**을 선택하고 결과를 검토합니다.
1. 선택적으로 임계값 수준을 변경하고 **테스트 실행**을 다시 선택합니다.
1. 왼쪽 탐색 모음에서 **텍스트용 보호자료감지**를 선택합니다.
1. **보호된 가사**를 선택하면 공개된 노래의 가사임을 확인할 수 있습니다.
1. **테스트 실행**을 선택하고 결과를 검토합니다.
1. 왼쪽 탐색 모음에서 **이미지 콘텐츠 조정**을 선택합니다.
1. **자신에게 피해 콘텐츠**를 선택합니다.
1. AI Studio에서는 기본적으로 모든 이미지가 흐리게 처리됩니다. 샘플에 포함된 성적인 콘텐츠는 강하지 않다는 점도 인지해야 합니다.
1. **테스트 실행**을 선택하고 결과를 검토합니다.
1. 왼쪽 탐색 모음에서 **프롬프트 쉴드**를 선택합니다.
1. **프롬프트 쉴드 페이지**의 **Azure AI 서비스**에서 이전에 만든 콘텐츠 보안 리소스를 선택합니다.
1. **프롬프트 및 문서 공격 콘텐츠**를 선택합니다. 사용자 프롬프트와 문서 텍스트에 잠재적인 문제가 있는지 검토합니다.
1. **테스트 실행**을 선택합니다.
1. **결과 보기**에서 사용자 프롬프트와 문서 모두에서 탈옥 공격이 감지되었는지 확인합니다.

    > [!TIP]
    > 코드는 AI Studio의 모든 샘플에 사용할 수 있습니다.

1. **다음 단계**의 **코드 보기**에서 **코드 보기**를 선택합니다. **샘플 코드** 창이 표시됩니다.
1. 아래쪽 화살표를 사용하여 Python 또는 C#을 선택한 다음 **복사**를 선택하여 샘플 코드를 클립보드에 복사합니다.
1. **샘플 코드** 화면을 닫습니다.

### 애플리케이션 사용

이제 C# 또는 Python으로 애플리케이션을 만들 수 있습니다.

#### C#

##### 필수 조건

* [지원되는 플랫폼](https://code.visualstudio.com/docs/supporting/requirements#_platforms) 중 하나인 [Visual Studio Code](https://code.visualstudio.com/).
* [.NET 8](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)은 이 연습의 대상 프레임워크입니다.
* Visual Studio Code용 [C# 확장](https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csharp).

##### 설치

다음 단계를 수행하여 연습을 위해 Visual Studio Code를 준비합니다.

1. Visual Studio Code를 시작하고 탐색기 보기에서 **.NET 프로젝트 만들기**를 클릭하고 **콘솔 앱**을 선택합니다.
1. 컴퓨터에서 폴더를 선택하고 프로젝트의 이름을 지정합니다. **프로젝트 만들기**를 선택하고 경고 메시지를 확인합니다.
1. 탐색기 창에서 솔루션 탐색기를 확장하고 **Program.cs**를 선택합니다.
1. **실행** -> **디버깅 없이 실행**을 선택하여 프로젝트를 빌드하고 실행합니다. 
1. 솔루션 탐색기에서 C# 프로젝트를 마우스 오른쪽 단추로 클릭하고 **NuGet 패키지 추가**를 선택합니다.
1. **Azure.AI.TextAnalytics**를 검색하고 최신 버전을 선택합니다.
1. 두 번째 NuGet 패키지인 **Microsoft.Extensions.Configuration.Json 8.0.0**를 검색합니다. 이제 프로젝트 파일에 두 개의 NuGet 패키지가 나열되어야 합니다.

##### 코드 추가

1. 앞서 복사한 샘플 코드를 **ItemGroup** 섹션 아래에 붙여넣습니다.
1. 아래로 스크롤하여 *사용자 구독 _키 및 엔드포인트로 바꾸기*를 찾습니다.
1. Azure Portal의 키 및 엔드포인트 페이지에서 키 중 하나(1 또는 2)를 복사합니다. **<your_subscription_key>** 을 이 값으로 바꿉니다.
1. Azure Portal의 키 및 엔드포인트 페이지에서 엔드포인트를 복사합니다. 이 값을 코드에 붙여넣어 **<your_endpoint_value>** 을 니다.
1. **Azure AI 스튜디오**에서 **사용자 프롬프트** 값을 복사합니다. 다음을 코드에 붙여넣어 **<test_user_prompt>** 을 바꿉니다.
1. **<this_is_a_document_source>** 까지 아래로 스크롤하여 이 코드 줄을 삭제합니다.
1. **Azure AI 스튜디오**에서 **문서** 값을 복사합니다.
1. **<this_is_another_document_source>** 까지 아래로 스크롤하여 문서 값을 붙여넣습니다.
1. **실행** -> **디버깅 없이 실행**을 선택하고 공격이 감지되었는지 확인합니다. 

#### Python

##### 필수 조건

* [지원되는 플랫폼](https://code.visualstudio.com/docs/supporting/requirements#_platforms) 중 하나인 [Visual Studio Code](https://code.visualstudio.com/).

* Visual Studio Code용 [Python 확장](https://marketplace.visualstudio.com/items?itemName=ms-python.python)이 설치됩니다.

* [요청 모듈](https://pypi.org/project/requests/)이 설치됩니다.

1. 확장자가 **.py**인 새 Python 파일을 만들고 적절한 이름을 지정합니다.
1. 이전에 복사한 샘플 코드를 붙여넣습니다.
1. 아래로 스크롤하여 *사용자 구독 _키 및 엔드포인트로 바꾸기*라는 제목의 섹션을 찾습니다.
1. Azure Portal의 키 및 엔드포인트 페이지에서 키 중 하나(1 또는 2)를 복사합니다. **<your_subscription_key>** 을 이 값으로 바꿉니다.
1. Azure Portal의 키 및 엔드포인트 페이지에서 엔드포인트를 복사합니다. 이 값을 코드에 붙여넣어 **<your_endpoint_value>** 을 니다.
1. **Azure AI 스튜디오**에서 **사용자 프롬프트** 값을 복사합니다. 다음을 코드에 붙여넣어 **<test_user_prompt>** 을 바꿉니다.
1. **<this_is_a_document_source>** 까지 아래로 스크롤하여 이 코드 줄을 삭제합니다.
1. **Azure AI 스튜디오**에서 **문서** 값을 복사합니다.
1. **<this_is_another_document_source>** 까지 아래로 스크롤하여 문서 값을 붙여넣습니다.
1. 파일에 대한 통합 터미널에서 프로그램을 실행합니다. 예:

    - `.\prompt-shield.py`

1. 공격이 감지되었는지 확인합니다.
1.  다양한 테스트 콘텐츠와 문서 값으로 실험할 수 있습니다.
